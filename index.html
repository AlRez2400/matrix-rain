<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Matrix 0/1 Rain</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #000; /* fallback while canvas initializes */
      overflow: hidden; /* keep the page clean */
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
    }

    /* Canvas fills the screen */
    #matrix {
      position: fixed;
      inset: 0;
      display: block;
      width: 100vw;
      height: 100vh;
    }

    /* Optional content container if you want to place UI on top */
    .content {
      position: relative;
      z-index: 1;
      color: #c8e6c9;
      text-align: center;
      padding-top: 20vh;
      text-shadow: 0 0 8px rgba(0,255,140,0.35);
      pointer-events: none; /* let clicks pass through */
    }

    /* Simple toggle panel (can be deleted) */
    .panel {
      position: fixed;
      right: 12px;
      bottom: 12px;
      z-index: 2;
      background: rgba(0,0,0,0.5);
      border: 1px solid rgba(0,255,140,0.25);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 12px;
      color: #a5d6a7;
      backdrop-filter: blur(6px);
    }
    .panel label { display: block; margin: 6px 0 2px; }
    .panel input[type="range"] { width: 160px; }
  </style>
</head>
<body>
  <canvas id="matrix" aria-hidden="true"></canvas>

  <div class="content" aria-live="polite">
    <!-- Optional overlay text; remove if you want only the background -->
    <h1 style="margin:0;font-weight:700;letter-spacing:.04em;">0101 MATRIX RAIN</h1>
    <p style="margin:.5rem 0 0;opacity:.8;">Background of falling 0s and 1s. Works on GitHub Pages.</p>
  </div>

  <!-- Optional controls (remove if not needed) -->
  <div class="panel" role="group" aria-label="Matrix settings">
    <label for="density">Density</label>
    <input id="density" type="range" min="0.2" max="2.2" step="0.1" value="1" />

    <label for="speed">Speed</label>
    <input id="speed" type="range" min="0.4" max="3.0" step="0.1" value="1.2" />

    <label for="fontSize">Font size</label>
    <input id="fontSize" type="range" min="10" max="32" step="1" value="16" />
  </div>

  <script>
    (() => {
      const canvas = document.getElementById('matrix');
      const ctx = canvas.getContext('2d', { alpha: false });

      // Tunables (linked to UI controls)
      const controls = {
        density: document.getElementById('density'),
        speed: document.getElementById('speed'),
        fontSize: document.getElementById('fontSize'),
      };

      // Color palette
      const bgColor = '#000000';
      const glyphColor = '#00ff8c';
      const glowColor = 'rgba(0,255,140,0.35)';

      let dpr = Math.max(1, Math.min(window.devicePixelRatio || 1, 2));
      let width = 0, height = 0;
      let columns = 0;          // number of columns across the screen
      let drops = [];           // y-position for each drop (per column)

      // We only use 0 and 1
      const glyphs = ['0', '1'];

      function resize() {
        dpr = Math.max(1, Math.min(window.devicePixelRatio || 1, 2));
        const cssW = window.innerWidth;
        const cssH = window.innerHeight;
        width = Math.floor(cssW * dpr);
        height = Math.floor(cssH * dpr);
        canvas.width = width;
        canvas.height = height;
        canvas.style.width = cssW + 'px';
        canvas.style.height = cssH + 'px';

        ctx.setTransform(1, 0, 0, 1, 0, 0);
        ctx.scale(dpr, dpr);

        setupColumns();
        clearCanvas(true);
      }

      function setupColumns() {
        const size = getFontSize();
        ctx.font = size + 'px monospace';
        columns = Math.floor(window.innerWidth / size);
        drops = new Array(columns).fill(0).map(() => Math.random() * -50);
      }

      function getFontSize() {
        return parseInt(controls.fontSize.value, 10);
      }

      function clearCanvas(hard = false) {
        // draw translucent rect for tail fade, or hard clear
        if (hard) {
          ctx.fillStyle = bgColor;
          ctx.fillRect(0, 0, canvas.width, canvas.height);
        } else {
          ctx.fillStyle = 'rgba(0, 0, 0, 0.08)';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
      }

      function drawFrame() {
        clearCanvas(false);

        const size = getFontSize();
        ctx.font = size + 'px monospace';
        ctx.textBaseline = 'top';
        ctx.shadowBlur = 8;
        ctx.shadowColor = glowColor;

        const baseSpeed = parseFloat(controls.speed.value);
        const density = parseFloat(controls.density.value);

        // compute how many columns to draw (density adjusts spacing)
        const step = Math.max(1, Math.round(1 / Math.min(density, 2.2)));

        for (let i = 0; i < columns; i += step) {
          const x = i * size;
          const y = drops[i] * size;
          const char = glyphs[(Math.random() * glyphs.length) | 0];

          // draw glow trail glyph
          ctx.fillStyle = glyphColor;
          ctx.fillText(char, x, y);

          // move drop downwards with some per-column variation
          drops[i] += baseSpeed * (0.9 + Math.random() * 0.35);

          // reset to a random negative start to stagger entries
          if (y > window.innerHeight) {
            drops[i] = -(Math.random() * 20);
          }
        }
        requestAnimationFrame(drawFrame);
      }

      // Initialize
      window.addEventListener('resize', resize, { passive: true });
      Object.values(controls).forEach(el => el && el.addEventListener('input', () => {
        setupColumns();
      }));

      resize();
      requestAnimationFrame(drawFrame);
    })();
  </script>
</body>
</html>
